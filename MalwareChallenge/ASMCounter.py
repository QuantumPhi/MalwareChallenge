import numpy as np
from os.path import expanduser

class ASMCounter():
    def __init__(self, path):
        self.dict = {}
        for value in ["aaa", "aad", "aam", "aas", "adc", "add", "and", "call", "clc", "cld", "cli", "cmc", "cmp", "cmpsb", "cmpsw", "cwd", "das", "dec", "div", "esc", "idiv", "imul", "in", "inc", "iret", "jcc", "jcxz", "jmp", "lahf", "lea", "les", "lodsb", "lodsw", "loop", "mov", "movsb", "movsw", "mul", "neg", "nop", "not", "or", "out", "pop", "push", "rcl", "rcr", "repxx", "ret", "retn", "retf", "ror", "sahf", "sar", "sbb", "scasb", "scasw", "shl", "shr", "stc", "std", "sti", "stosb", "stosw", "sub", "test", "wait", "xchg", "xlat", "xor"]:
            self.dict[value] = 0
        self.file = [row for row in open(expanduser(path), "r")]
        print len(self.file)
        self.__keyword_dict()
    def __keyword_dict(self):
        for key in str(self.file[:1000]).split():
            for value in self.dict.keys():
                if value == key:
                    self.dict[value] += 1