import csv
import random
from os import listdir
from os.path import expanduser, splitext

class ByteEnumerator():
    def __init__(self, csv_path, root):
        self.root = expanduser(root)
        self.malware_class = dict([row for row in csv.reader(open(expanduser(csv_path), "r"))][1:])
    def next_file(self):
        self.__index += 1
        yield ([splitext(rand)[0] for rand in listdir(self.root) if splitext(rand)[1] == ".bytes"])[self.__index]
    def next_files(self, iter):
        self.__index = -1
        return [next(self.next_file()) for x in range(iter)]
    def random_file(self):
        return random.choice([splitext(rand)[0] for rand in listdir(self.root) if splitext(rand)[1] == ".bytes"])