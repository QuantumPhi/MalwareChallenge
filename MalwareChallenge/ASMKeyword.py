import matplotlib.pyplot as plt
import numpy as np
from os.path import expanduser

class ASMKeyword():
    def __init__(self, path):
        self.dict = {}
        for value in ["aaa", "aad", "aam", "aas", "adc", "add", "and", "call", "cbw", "clc", "cld", "cli", "cmc", "cmp", "cmpsb", "cmpsw", "cwd", "daa", "das", "dec", "div", "esc", "hlt", "idiv", "imul", "in", "inc", "int", "into", "iret", "jcc", "jcxz", "jmp", "lahf", "lds", "lea", "les", "lock", "lodsb", "lodsw", "loop", "mov", "movsb", "movsw", "mul", "neg", "nop", "not", "or", "out", "pop", "popf", "push", "pushf", "rcl", "rcr", "repxx", "ret", "retn", "retf", "rol", "ror", "sahf", "sal", "sar", "sbb", "scasb", "scasw", "shl", "shr", "stc", "std", "sti", "stosb", "stosw", "sub", "test", "wait", "xchg", "xlat", "xor"]:
            self.dict[value] = 0
        self.file = [row for row in open(expanduser(path), "r")]
        print len(self.file)
    def keyword_dict(self, batch_size):
        i = 1
        while i*batch_size < len(self.file):
            for key in str(self.file[(i-1)*batch_size:i*batch_size]).split():
                if self.dict.has_key(key):
                    self.dict[key] += 1
            i += 1
    def normal_dict(self):
        return self.dict.values()/np.linalg.norm(self.dict.values())
    def show_keywords(self):
        plt.plot(self.normal_dict())
        plt.show()
        